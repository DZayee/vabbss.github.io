---
bố cục: bài
title: Cách xây dựng một trang web nội bộ trong khuôn viên trường
tags: [trang web, khuôn viên trường]
---
Trên thực tế, tôi cảm thấy rằng cuộc sống đại học cũng khá tốt. <! - more ->

# Nguyên nhân
Sau khi vào đại học năm ngoái, tôi tham gia một nhóm chuyên về điện toán đám mây và mạng (trên danh nghĩa), nhưng lúc đó tôi là sinh viên năm nhất và tôi không được phép tham gia. Vào năm thứ hai, tôi đã thành công trong việc quản lý, và lần này tôi có thể nhìn lại những điều thú vị ở câu lạc bộ này.
Trước hết, cộng đồng có mạng riêng của mình, và có một bộ chuyển mạch trong văn phòng cộng đồng kết nối với mạng của tòa nhà giảng dạy nơi nó đặt trụ sở. Ngoài ra còn có Raspberry Pi, dường như chưa được sử dụng một lần và hệ thống cũng là một RPiOS hoàn toàn mới.
Ngoài ra, có một máy chủ gắn trên giá đỡ trong cộng đồng, dường như đã vô dụng trong một thời gian dài, lỗi bộ nhớ đã được báo cáo trực tiếp khi nó được khởi động lần đầu tiên.
Tôi đã từng nghĩ rằng cấu hình máy chủ phải khá cao, nếu không có TR3990X hai chiều và toàn bộ ngăn xếp bộ nhớ TiB thì không thể gọi là máy chủ được. Nhưng máy chủ thư rác này đã thay đổi suy nghĩ của tôi. Đây là máy chủ có kiểu bo mạch chủ là S5500HCV, với CPU kép và 4 thẻ nhớ 4GiB. Đĩa cứng là 500GiB hoặc cơ học. Hãy xem xét kỹ hơn cách CPU ổ cắm kép này chỉ thêm vào 8 lõi và không hỗ trợ siêu phân luồng? Cấu hình này không bằng chiếc laptop mình mới mua, kích thước rất khủng, lớn hơn nhiều so với mặt bằng chung, khởi động chậm, quạt không hỗ trợ điều chỉnh tốc độ, đúng là rác rưởi.
Nhưng rác là rác, dù sao nó vẫn là máy chủ, ít nhất nó có thể hỗ trợ hệ thống làm việc 24/7, điện liên tục 365 ngày nên được đảm bảo. Bây giờ chúng ta có những tài nguyên như vậy, tôi nghĩ chúng ta nên làm một cái gì đó trên máy chủ, nếu không sẽ lãng phí một việc lớn như vậy.

# Hành trình lật máy chủ
Lúc đầu, tôi định cài đặt ESXi, vì về cơ bản tôi chưa bao giờ sử dụng VMWare kể từ Hyper-V, và cả hai loại trừ lẫn nhau. Sau khi nhìn thấy ESXi trước đó, tôi muốn cài đặt một cái trong máy ảo Hyper-V. Thật không may, hệ thống ESXi quá rác. Việc cài đặt yêu cầu trình điều khiển cạc mạng và nó hỗ trợ rất ít trình điều khiển, vì vậy lần này chúng tôi có một máy chủ thực. Đương nhiên, tôi muốn thử chơi với ESXi.
Đầu tiên là mình cài ESXi7, sau khi mở lên thì không có driver card đồ họa nên phải dùng thử ESXi6, sau khi mở thì cài được nhưng cài xong thì không khởi động được, lạ quá. nên tôi đã phải từ bỏ ý tưởng cài đặt ESXi.
Sau đó, tôi nghĩ đến việc cài hệ điều hành server bình thường, Ubuntu dùng nhiều thì chỉ cần cài đặt CentOS. Tuy nhiên, có rất nhiều cạm bẫy trong CentOS, vì tôi không thể cài đặt nó bằng CD-ROM. Tôi thường ghi nó vào đĩa U trước khi cài đặt. Nhưng tôi không biết tại sao. Nếu bạn có thể sử dụng 11 chữ số nhãn khối lượng, chương trình cài đặt sẽ không thể khởi động.
Ngoài sự hầm hố này, giữa phiên bản 8 luồng và 8 luồng còn có một điểm khác biệt nữa. Vì rất phiền phức khi tải trực tiếp toàn bộ CentOS nên tôi đã tải trực tiếp phiên bản cài đặt mạng. Chương trình cài đặt mình tải về là 8 luồng nhưng lúc đó mình không biết sử dụng nguồn nào, kết quả là bị nguồn 8. Mình bị lỗi và thoát ra giữa chừng khi cài đặt, rất khó chịu. Sau khi kiểm tra cẩn thận, tôi phát hiện ra rằng phiên bản đã bị sai.
Sau khi cài đặt xong đặt ra câu hỏi là quản lý server như thế nào, mặc dù dùng trực tiếp SSH hay Cockpit tích hợp cũng tốt, nhìn rất chuyên nghiệp nhưng mình nghĩ dùng trực tiếp xóa Kuta nào đó thì hơi phiền. , dù sao thì nó cũng nằm trong mạng nội bộ. Sẽ không có ai tấn công và việc cài đặt và cấu hình thực sự rất tiện lợi, bạn có thể làm những gì bạn muốn chỉ với một cú nhấp chuột.
Mặc dù máy chủ này khá rác, nhưng ít nhất nó cũng mạnh hơn máy chủ đám mây trung bình, máy chủ đám mây có cấu hình tương tự tốn rất nhiều tiền, tôi chắc chắn sẽ không thuê nó, và tất nhiên là tôi chưa sử dụng nó. Vì vậy, tôi có thể cài đặt bất kỳ thứ gì như Gitlab và không lo lắng về việc có 16 GiB bộ nhớ.
Thứ hai là môi trường của máy chủ web, bảng điều khiển thực sự thuận tiện, bạn có thể dễ dàng cài đặt blog, diễn đàn và đĩa mạng. Bây giờ trang web đã được xây dựng, chúng ta phải xem xét làm thế nào để truy cập nó.

# Cách mở máy chủ tự tạo
Trong trường hợp bình thường, các mạng chúng ta sử dụng đều thông qua bộ định tuyến, sau đó sẽ có NAT và không thể truy cập các dịch vụ bên trong từ bên ngoài. Trong trường hợp bình thường, để giải quyết vấn đề này là sử dụng thâm nhập mạng nội bộ, chẳng hạn như frp và những thứ tương tự. Tuy nhiên, trang web của chúng tôi không phù hợp để tiếp xúc với Internet, xét cho cùng, rất nhiều dịch vụ được mở ra, không có tường lửa và mật khẩu cực kỳ đơn giản. .
Nếu không thể tiếp xúc với mạng bên ngoài thì ít nhất mạng nội bộ của trường cũng có thể truy cập được. Tuy nhiên, một bộ định tuyến được kết nối phía trước máy chủ. Sau khi chuyển đổi, không có cách nào để truy cập vào mạng trong trường. May mắn thay, bộ định tuyến có thể đặt máy chủ DMZ, đặt IP nội bộ của máy chủ thành tĩnh và sau đó mở máy chủ DMZ để giải quyết vấn đề này. Ngoài ra, mạng nội bộ khuôn viên kết nối với bộ định tuyến không có NAT nên nó có thể chạy trực tiếp trong khuôn viên trường.

# Thêm tên miền vào trang web
Mặc dù phương pháp trên cho phép mọi người truy cập vào máy chủ, nhưng có một vấn đề với IP động. Tôi có thể thay đổi bộ định tuyến trong cộng đồng, nhưng tôi không thể thay đổi bộ chuyển đổi trong trường nên địa chỉ IP không thể sửa được, mặc dù cũng có thể đổi thành IP cố định trực tiếp trên máy chủ, nhưng tôi lo lắng rằng điều này sẽ gây ra các vấn đề như xung đột IP. Tình huống này rất rắc rối, bởi vì nhiều trang web là URL có địa chỉ trang web, các trang web tôi xây dựng được xây dựng thông qua các công cụ, và rất rắc rối khi thay đổi nó.
Giải pháp tốt hơn cho vấn đề này là sử dụng tên miền. Kết quả của việc phân giải tên miền không nhất thiết phải là địa chỉ mạng bên ngoài. Địa chỉ mạng nội bộ cũng có thể được giải quyết. Bằng cách này, tôi có thể mua một tên miền và giải quyết nó sau này. Nếu cúp điện hoặc sự cố khác khiến IP thay đổi, tôi chỉ có thể thay đổi nó một lần. DDNS cũng là một giải pháp hay, nhưng kiểu này cũng không xảy ra nhiều lần nên mình cũng không thèm làm.

# Sử dụng hợp lý tài nguyên
Mặc dù trang web được xây dựng nhưng không có ai truy cập thường xuyên ... và ngay cả khi có người truy cập vào máy chủ để chạy chương trình dịch vụ trang web, về cơ bản không có áp lực, vì vậy hoạt động của máy chủ về cơ bản là không tải. Vì mình định để nó chạy liên tục nên chắc chắn không thể để nó chạy ì ạch được, vì vậy mình phải làm gì đó để sử dụng tốt nguồn tài nguyên máy tính này. Khai thác mỏ là một lựa chọn tốt, nhưng tôi không bận tâm. Tốt hơn hết hãy làm điều gì đó đóng góp vào sự phát triển của con người. Các dự án điện toán tự nguyện như World Community Grid là khá tốt.
Vì vậy, tôi đã cài đặt BOINC trên đó, mặc dù loại chương trình này sẽ chiếm nhiều tài nguyên máy tính nhưng mức độ ưu tiên chạy của nó rất thấp, vì vậy hoạt động của trang web không có tác dụng gì cả, để có thể sử dụng hợp lý các tài nguyên máy tính này.
